<!-- Sidebar -->
<aside *ngIf="auth.isLoggedIn() && !isLocked"
  [class]="'fixed left-0 top-0 z-40 h-screen bg-slate-900 text-slate-300 border-r border-slate-800 shadow-lg transition-all duration-300 ' + (isExpanded ? 'w-64' : 'w-16')"
>
  <div class="flex flex-col h-full">
    <!-- Brand/Logo and Toggle -->
    <div class="flex items-center h-16 border-b border-slate-800 px-2 relative">
      <!-- When Collapsed: Show only logo centered -->
      <div *ngIf="!isExpanded" class="flex items-center justify-center w-full">
        <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
          <span class="text-white font-bold text-sm">D</span>
        </div>
      </div>
      
      <!-- When Expanded: Show logo + brand + toggle -->
      <div *ngIf="isExpanded" class="flex items-center justify-between w-full">
        <div class="flex items-center">
          <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
            <span class="text-white font-bold text-sm">D</span>
          </div>
          <span class="ml-3 text-lg font-semibold text-white">
            LocationDeco
          </span>
        </div>
        
        <!-- Toggle Button - right side when expanded -->
        <button
          (click)="toggleSidebar()"
          class="p-1.5 rounded-md hover:bg-slate-800 transition-colors duration-200"
        >
          <i class="fas fa-chevron-left text-sm"></i>
        </button>
      </div>
    </div>

    <!-- Toggle Button for Collapsed State - positioned at top -->
    <div *ngIf="!isExpanded" class="absolute top-2 right-2 z-10">
      <button
        (click)="toggleSidebar()"
        class="p-3  opacity-0  rounded-md hover:bg-slate-700 bg-slate-800 text-slate-300 hover:text-white transition-colors duration-200 shadow-md"
      >
        <i class="fas fa-bars text-xs"></i>
      </button>
    </div>

    <!-- Navigation -->
    <nav class="flex-1 px-2 py-4 space-y-2">
      @for (item of navItems; track item.route) {
      <a
        [routerLink]="item.route"
        routerLinkActive="bg-blue-600 text-white shadow-md"
        [routerLinkActiveOptions]="{ exact: true }"
        class="group flex items-center h-12 rounded-md hover:bg-slate-800 hover:text-white transition-all duration-200 relative"
        [attr.aria-label]="item.label"
      >
        <!-- When Collapsed: Center the icon -->
        <div *ngIf="!isExpanded" class="flex items-center justify-center w-full h-full">
          <ng-container [ngSwitch]="item.route">
            <i *ngSwitchCase="'/home'" class="fas fa-home text-lg"></i>
            <i *ngSwitchCase="'/calendar'" class="fas fa-calendar text-lg"></i>
            <i *ngSwitchCase="'/articles'" class="fas fa-box text-lg"></i>
            <i *ngSwitchCase="'/reservations'" class="fas fa-calendar-check text-lg"></i>
            <i *ngSwitchCase="'/clients'" class="fas fa-users text-lg"></i>
            <i *ngSwitchCase="'/gallery'" class="fas fa-image text-lg"></i>
            <i *ngSwitchCase="'/administration'" class="fas fa-user-shield text-lg"></i>
          </ng-container>
        </div>
        
        <!-- When Expanded: Show icon + label -->
        <div *ngIf="isExpanded" class="flex items-center w-full px-3  overflow-hidden">
          <div class="flex items-center justify-center w-6 h-6 flex-shrink-0 overflow-hidden">
            <ng-container [ngSwitch]="item.route">
              <i *ngSwitchCase="'/home'" class="fas fa-home text-lg"></i>
              <i *ngSwitchCase="'/calendar'" class="fas fa-calendar text-lg"></i>
              <i *ngSwitchCase="'/articles'" class="fas fa-box text-lg"></i>
              <i *ngSwitchCase="'/reservations'" class="fas fa-calendar-check text-lg"></i>
              <i *ngSwitchCase="'/clients'" class="fas fa-users text-lg"></i>
              <i *ngSwitchCase="'/gallery'" class="fas fa-image text-lg"></i>
              <i *ngSwitchCase="'/administration'" class="fas fa-user-shield text-lg"></i>
            </ng-container>
          </div>
          <span class="ml-3 text-sm font-medium whitespace-nowrap">
            {{ item.label }}
          </span>
        </div>

        <!-- Tooltip (only show when collapsed) -->
        <div
          *ngIf="!isExpanded"
          class="absolute left-16 bg-slate-800 text-white text-sm px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50"
        >
          {{ item.label }}
        </div>
      </a>
      }
    </nav>

    <!-- Create Reservation Button -->
    <div class="px-2 pb-2">
      <button
        [routerLink]="'/reservations/new'"
        class="group flex items-center h-12 rounded-md bg-emerald-600 text-white shadow-md hover:bg-emerald-700 transition-all duration-200 transform hover:scale-105 relative w-full"
        title="Créer une réservation"
      >
        <!-- When Collapsed: Center the icon -->
        <div *ngIf="!isExpanded" class="flex items-center justify-center w-full h-full">
          <i class="fas fa-plus text-lg"></i>
        </div>
        <!-- When Expanded: Show icon + label -->
        <div *ngIf="isExpanded" class="flex items-center w-full px-3">
          <div class="flex items-center justify-center w-6 h-6 flex-shrink-0">
            <i class="fas fa-plus text-lg"></i>
          </div>
          <span class="ml-3 text-sm font-medium whitespace-nowrap">
            Créer une réservation
          </span>
        </div>
        <!-- Tooltip (only show when collapsed) -->
        <div
          *ngIf="!isExpanded"
          class="absolute left-16 bg-slate-800 text-white text-sm px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50"
        >
          Créer une réservation
        </div>
      </button>
    </div>
    <!-- Logout Button -->
    <div class="px-2 pb-4">
      <button
        (click)="logout()"
        class="group flex items-center h-12 rounded-md bg-red-600 text-white shadow-md hover:bg-red-700 transition-all duration-200 transform hover:scale-105 relative w-full"
        title="Se déconnecter"
      >
        <div *ngIf="!isExpanded" class="flex items-center justify-center w-full h-full">
          <i class="fas fa-sign-out-alt text-lg"></i>
        </div>
        <div *ngIf="isExpanded" class="flex items-center w-full px-3">
          <div class="flex items-center justify-center w-6 h-6 flex-shrink-0">
            <i class="fas fa-sign-out-alt text-lg"></i>
          </div>
          <span class="ml-3 text-sm font-medium whitespace-nowrap">
            Se déconnecter
          </span>
        </div>
        <div
          *ngIf="!isExpanded"
          class="absolute left-16 bg-slate-800 text-white text-sm px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50"
        >
          Se déconnecter
        </div>
      </button>
    </div>
  </div>
</aside>

<!-- Main Content -->
<main 
  class="min-h-screen bg-slate-100 transition-all duration-300"
  [class.ml-64]="auth.isLoggedIn() && isExpanded && !isLocked"
  [class.ml-16]="auth.isLoggedIn() && !isExpanded && !isLocked"
  [class.w-full]="!auth.isLoggedIn() || isLocked"
>
  <div class="w-full">
    <router-outlet></router-outlet>
  </div>
</main>